'use strict';(function(d){function w(a,c){var f="",e="",p=a.find("input"),h=b.session.getTextRange(b.getSelectionRange());0<h.trim().length&&p.eq(0).val(h);a.find(".modal-footer button.btn-success").on("click.codeparlMarkdown",function(){f=p.eq(0).val();e=p.eq(1).val();0<e.length&&0<f.length?(a.modal("hide"),c?l.insertSnippet(b,"["+f+"]("+e+")"):l.insertSnippet(b,"!["+f+"]("+e+")")):x(a)})}function m(a,c){var f=b.session.getTextRange(b.getSelectionRange())||"",e=b.find(c,{wrap:!0,caseSensitive:!0,
wholeWord:!0,regExp:!1,preventScroll:!0});null!==e?b.session.replace(e,c):0===b.getCursorPosition().column?(b.navigateLineStart(),"``"===a?b.insert("`"+c+"` "):b.insert(a+c+" "),b.navigateLineEnd()):0<f.trim().length?(e=b.getSelectionRange(),"``"===a?(b.insert("`"+f+"` "),b.session.replace(e,"`"+f+"` ")):b.session.replace(e,a+f)):("``"===a?b.insert("`"+c+"` "):b.insert(a+c+" "),b.navigateLineEnd());b.find(c);b.focus()}function y(a){"function"!==d.type(d().modal)&&d.error("bootstrap.min.js is required for this plugin");
var c='<div class="modal fade " data-backdrop="false" id="codeparlMarkdown-modal"  tabindex="-1" role="dialog"><div class="modal-dialog   " role="document"><div class="modal-content"><div class="modal-header "><h4 class="modal-title text-capitalize "> '+(a.title+"</h4>");c=d(c+' <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div><div class="modal-footer mx-auto text-center w-100"><button class="btn btn-sm btn-success">OK</button><button data-dismiss="modal" class="btn btn-sm btn-danger">cancel</button></div> </div></div> </div>').on("hidden.bs.modal",
function(){d(this).remove()});c.find(".modal-body").html(a.body);C(c);return c}function C(a){a.on("click.codeparlMarkdown",function(c){d(c.target).is(".modal-dialog *")||x(a)})}function z(a,c){a=a?a:"Text";c=c?c:"URL";var f=d("<input>").attr({type:"text",placeholder:"Enter "+a}).prop("required",!0).addClass("form-control form-control-sm");f=d("<label>").addClass("w-100").text(a+":").append(f);a=d("<input>").attr({type:c,placeholder:"Enter "+c}).prop("required",!0).addClass("form-control form-control-sm");
a=d("<label>").addClass("w-100").text(c+":").append(a);return d("<div>").append(f).append(a)}function A(a,c){a?(q.show(),n.hide(),d(".cpme-btn-normal").prop("disabled",!1).removeClass("disabled")):(q.hide(),n.show(),a=B.makeHtml(b.session.getValue()),g.onPreview(t(a)),n.html(t(a)),d(".cpme-btn-normal").prop("disabled",!0).addClass("disabled"));c.addClass("active");c.siblings("button").removeClass("active")}function D(a){a.on("change.codeparlMarkdown",function(){g.onFileBrowse(a,b)})}function t(a){if(!g.allowScript)return a.replace("<script>",
"&lt;script&gt;")}function x(a){a.find(".modal-content").addClass(" animated fast headShake");setTimeout(function(){a.find(".modal-content").removeClass("animated fast headShake")},1E3)}function E(){k.find(".cpme-toolbar .cpme-btn").each(function(){d(this).on("click.codeparlMarkdown",function(a){a.preventDefault();a=d(this);var c=a.data("action");d("[data-original-title").tooltip("hide");switch(c){case "preview":A(!1,a);break;case "edit":A(!0,a);break;case "browse":a=a.next(".cpme-file-browser");
D(a);a.trigger("click.codeparlMarkdown");break;case "fullscreen":d("body").toggleClass("cpme-fullscreen");k.toggleClass("fullscreen");a.find("i").toggleClass("fa-expand fa-compress");a.find("i").hasClass("fa-expand")?a.attr("data-original-title","Fullscreen"):a.attr("data-original-title","Restore");break;case "h1":m("# ","type your heading here");break;case "h2":m("## ","type your heading here");break;case "ul":m("* ","type your item here");break;case "ol":m("1. ","type your item here");break;case "block":m("> ",
"type here");break;case "code":m("``","enter code here");break;case "bold":b.execCommand("bold");break;case "italic":b.execCommand("italic");break;case "link":b.execCommand("link");break;case "image":a=y({title:"Enter Image URL",body:z("Alt Text")}).modal("show"),w(a,!1)}})})}function F(){var a=d("<div>").addClass("cpme-toolbar border-bottom p-1 ").css({backgroundColor:g.toolbar.bg});for(const p in g.toolbar.buttonGroups){var c=g.toolbar.buttonGroups[p];var f=a;f=d("<div>").addClass("btn-group cpme-btn-group   mr-1").appendTo(f);
for(const h in c)if(r.hasOwnProperty(h)){var e=d("<button>").addClass("btn btn-sm  cpme-btn").attr({"data-action":r[h].action,type:"button"}).attr("title",r[h].tooltip);if(null===c[h].match(/^(fa\-.+?)$/))e.text(c[h]);else{if(!1===g.fullscreen&&"btnFullscreen"===h)continue;e.html(d("<i>").addClass("fa "+c[h]))}f.append(e);"btnEdit"===h&&(f.addClass("float-right"),e.addClass("active"));-1!==d.inArray(h,["btnEdit","btnPreview"])?e.append(d("<span>").text(r[h].tooltip)):e.addClass("cpme-btn-normal");
"btnFullscreen"===h&&e.removeClass("cpme-btn-normal");"btnbrowse"===h&&d("<input>").attr({type:"file",accept:".md, .markdown"}).addClass("cpme-file-browser ").hide().insertAfter(e);"function"===typeof d().tooltip&&e.tooltip()}}return a}function G(){b=ace.edit(q.get(0));b.setTheme("ace/theme/"+g.editor.theme);b.getSession().setMode("ace/mode/markdown");b.getSession().setUseWrapMode(!0);b.getSession().setUseSoftTabs(g.editor.softTabs);ace.config.loadModule("ace/ext/language_tools",function(){l=ace.require("ace/snippets").snippetManager;
b.commands.addCommand(u.bold);b.commands.addCommand(u.italic);b.commands.addCommand(u.link)})}var b=null,l=null,k=null,q,n,g=null,B=new showdown.Converter,r={btnHeader1:{tooltip:"Heading 1 <h1>",action:"h1"},btnHeader2:{tooltip:"Heading 2 <h2>",action:"h2"},btnBold:{tooltip:"Strong <strong> ",action:"bold"},btnItalic:{tooltip:"Empasise <em>",action:"italic"},btnbrowse:{tooltip:"Open a markdown file",action:"browse"},btnCode:{tooltip:"Code Sample <pre><code>",action:"code"},btnBlock:{tooltip:"Blockquote <blockquote>",
action:"block"},btnList:{tooltip:"Bulleted list <ul>",action:"ul"},btnOrderedList:{tooltip:"Numbered list <ol>",action:"ol"},btnLink:{tooltip:"Hyperlink <a>",action:"link"},btnImage:{tooltip:"Insert image <img>",action:"image"},btnEdit:{tooltip:"Edit",action:"edit"},btnPreview:{tooltip:"Preview",action:"preview"},btnFullscreen:{tooltip:"Fullscreen",action:"fullscreen"}},u={bold:{name:"bold",bindKey:{win:"Ctrl-B",mac:"Command-B"},exec:function(){var a=b.session.getTextRange(b.getSelectionRange());
0===a.trim().length?(l.insertSnippet(b,"**${1:text}**"),b.find("text")):l.insertSnippet(b,"**"+a+"**");b.focus()},readOnly:!1},italic:{name:"italic",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:function(){var a=b.session.getTextRange(b.getSelectionRange());""===a?(l.insertSnippet(b,"*${1:text}*"),b.find("text")):l.insertSnippet(b,"*"+a+"*");b.focus()},readOnly:!1},link:{name:"link",bindKey:{win:"Ctrl-K",mac:"Command-K"},exec:function(){var a=y({title:"Enter Url",body:z()}).modal("show");w(a,!0)},readOnly:!1}},
v={init:function(a){g=d.extend(!0,{},d.fn.codeparlMarkdown.defaults,a);q=this;0<this.filter(function(){return d(this).data("codeparlMarkdown")}).length&&d.error("The plugin has already been initialized.");this.data("codeparlMarkdown",g);this.css({height:g.editor.editorHeight}).addClass("cpme-editor");k=this.parent();k.addClass("w-100 border cpmd-container ").css({backgroundColor:"#F7F7F4"});F(g).prependTo(k);n=d("<div>").addClass("cpme-preview markdown-body overflow-auto p-2 bg-white border").hide().appendTo(k).css({height:g.editor.editorHeight});
G(g);E(g);return this},markdownContent:function(a){if(a)b.session.setValue(a),b.clearSelection();else return b.session.getvalue()},htmlContent:function(){return B.makeHtml(b.session.getValue())},preview:function(a){g=d.fn.codeparlMarkdown.defaults;k=this.parent();n=d("<div>").addClass("cpme-preview markdown-body overflow-auto p-2 bg-white border").appendTo(k).css({height:g.editor.editorHeight});this.html(n.html(t(a)))},destroy:function(){}};d.fn.codeparlMarkdown=function(a){if(v[a])return v[a].apply(this,
Array.prototype.slice.call(arguments,1));if("object"!==d.type(a)&&a)d.error("The method "+a+" does not exist on codeparlMarkdown");else return v.init.apply(this,arguments)};d.fn.codeparlMarkdown.defaults={fullscreen:!0,content:{allowScript:!1},editor:{softTabs:!0,theme:"tomorrow",editorHeight:"500px",editorWidth:"100%"},toolbar:{bg:"#F7F7F4",buttonGroups:[{btnHeader1:"H1",btnHeader2:"H2"},{btnBold:"fa-bold",btnItalic:"fa-italic"},{btnList:"fa-list-ul",btnOrderedList:"fa-list-ol"},{btnBlock:"fa-quote-left",
btnCode:"{ }"},{btnLink:"fa-link",btnImage:"fa-image"},{btnEdit:"fa-edit",btnbrowse:"fa-folder-open",btnPreview:"fa-eye",btnFullscreen:"fa-expand"}]},loading:"fa-spinner fa-spin",onFileBrowse:function(a,c){if(a[0].files[0]){var f=new FileReader;f.onload=function(e){c.session.setValue(e.target.result);c.clearSelection()};f.readAsText(a[0].files[0])}},onPreview:function(a){}}})(jQuery);