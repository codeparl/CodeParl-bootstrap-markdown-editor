'use strict';(function(b,z){function A(){var a="",c=b(".cpme-modal.link-modal"),e="",g=c.find("input[type=text] , input[type=url]"),u=d.session.getTextRange(d.getSelectionRange())||"";g.eq(0).val(u);c.find(".cpme-select-url").on("click.codeparlMarkdown",function(){a=g.eq(0).val();e=g.eq(1).val();0<e.length&&0<a.length&&(-1==e.search(/https?/)&&(e="http://"+e),m.insertSnippet(d,"["+a+"]("+e+")"),b('button[data-action="link"]').trigger("click.codeparlMarkdown"))}).next("button").on("click.codeparlMarkdown",
function(){b('button[data-action="link"]').trigger("click.codeparlMarkdown")})}function n(a,c){var e=d.session.getTextRange(d.getSelectionRange())||"";e.trim();var g=d.find(c,{wrap:!0,caseSensitive:!0,wholeWord:!0,regExp:!1,preventScroll:!0});"rule"===c?(d.insert(a),d.navigateLineEnd()):(null!==g?d.session.replace(g,c):0===d.getCursorPosition().column?"``"===a?d.insert("`"+c+"`"):d.insert(a+c+""):0<e.length?(g=d.getSelectionRange(),"``"===a?(d.insert("`"+e+"`"),d.session.replace(g,"`"+e+"`")):d.session.replace(g,
a+e)):(d.navigateLineStart(),"``"===a?d.insert("`"+c+"`"):d.insert(a+c+" "),d.navigateLineEnd()),0===e.trim().length&&d.find(c),d.focus())}function E(a,c){m.insertSnippet(d,"!["+c+"]("+a+")");b('button[data-action="image"]').trigger("click.codeparlMarkdown")}function F(){b(".cpme-browse-img :input").on("change.codeparlMarkdown",function(){var a=b(this);a[0].files&&a[0].files[0]&&B(a[0].files[0])})}function G(a){b("button.cpme-select-img").on("click.codeparlMarkdown",function(){0!==f.content.image.backendScript.trim().length&&
(b(this).css("width","86.4333px").html(b("<i>").addClass("fas fa-spinner fa-spin")),b.ajax({url:f.content.image.backendScript,type:"post",processData:!1,dataType:"json",cache:!1,async:!1,contentType:!1,data:C}).done(function(c){c.imageUrl&&a(c.imageUrl,c.name)}).fail(function(c){}))})}function B(a){var c=new FileReader;c.onload=function(e){b(".cpme-drag-drop img").attr("src",e.target.result)};c.readAsDataURL(a);C.append("image",a);G(E);b("button.cpme-select-img").prop("disabled",!1)}function H(){b(".cpme-drag-drop").on("dragenter.codeparlMarkdown, dragover.codeparlMarkdown",
function(a){a.stopPropagation();a.preventDefault()}).on("drop.codeparlMarkdown",function(a){a.preventDefault();(a=a.originalEvent.dataTransfer.files)&&a[0]&&B(a[0])})}function I(){var a=b("<select>").addClass("custom-select cpme-font-size py-1 ").on("change.codeparlMarkdown",function(){d.setOption("fontSize",f.editor.fontSizes[b(this).val()])});for(const e in f.editor.fontSizes){var c=b("<option>").text(e).appendTo(a);e===f.editor.defaultFont&&c.attr("selected","selected")}return a}function q(){var a=
b(".cpme-help-bar"),c=b("<div>").addClass("cpme-modal   w-100 position-absolute ");c.insertBefore(a).css({top:a.height()});a=b("<div>").addClass("cpme-modal-content d-flex flex-column mx-auto my-3   ");a.appendTo(c);return{pane:c,content:a}}function J(){var a=q().pane.addClass("link-modal"),c=q().content;c.addClass("w-50 mx-auto");b("<label>").text("Text").append(b("<input>").attr({type:"text",placeholder:"Enter url text here..."}).addClass("form-control")).appendTo(c);b("<label>").text("URL").append(b("<input>").attr({type:"url",
placeholder:"e.g. http://example.com"}).addClass("form-control")).appendTo(c);b("<div>").addClass("text-center my-3").append(b("<button>").prop("disabled",!1).addClass("btn cpme-select-url btn-lg mr-2 btn-success  ").text("Add")).append(b("<button>").addClass("btn btn-lg btn-danger ").text("Cancel")).appendTo(c);A();return a}function K(){var a=q().pane.addClass("image-modal"),c=q().content,e=f.content.image.types,g={height:f.editor.editorHeight-130+"px","background-image":"url("+f.content.image.placeholder+
")"};b("<div>").addClass("d-flex border p-2 bg-light shadow").html(b("<label>").text("Browse an image...").append(b("<input>").attr({type:"file",accept:e}).hide()).addClass("cpme-zoom-hover bg-success cpme-browse-img  d-block text-white ")).appendTo(c);b("<div>").addClass("cpme-drag-drop position-relative shadow-lg w-100 border mt-3 mb-2 mx-auto").css(g).append(b("<img>").attr({alt:"",src:""}).addClass(" mx-auto d-block p-0 img-fluid ")).appendTo(c).append(b("<p>").addClass("position-absolute h2").text("Drag and drop an image here"));
b("<div>").addClass("text-center my-3").append(b("<button>").prop("disabled",!0).addClass("btn cpme-select-img btn-lg mr-2 btn-success  ").text("Select")).append(b("<button>").addClass("btn btn-lg btn-danger ").text("Cancel")).appendTo(c);b("button.cpme-select-img").next("button").on("click.codeparlMarkdown",function(){b('button[data-action="image"]').trigger("click.codeparlMarkdown")});H();return a}function L(a){return b("<div>").addClass("btn-group cpme-btn-group   mr-1").appendTo(a)}function D(a,
c){if(a)p.show(),k.hide(),b(".cpme-btn-normal").prop("disabled",!1).removeClass("disabled");else{p.hide();k.show();a=d.session.getValue();var e=r.makeHtml(a);f.onPreview(v(e),a);k.html(v(e));Prism.highlightAllUnder(k[0]);b(".cpme-btn-normal").prop("disabled",!0).addClass("disabled")}c.addClass("active");c.siblings("button").removeClass("active")}function M(a){a.on("change.codeparlMarkdown",function(){f.onFileBrowse(a,d)})}function v(a){if(!f.allowScript)return a.replace("<script>","&lt;script&gt;")}
function N(){l.find(".cpme-toolbar .cpme-btn").each(function(){b(this).on("click.codeparlMarkdown",function(a){a.preventDefault();a=b(this);var c=a.data("action");b("[data-original-title]").tooltip("hide");switch(c){case "help":b(".cpme-help-bar").slideToggle("fast");break;case "preview":D(!1,a);break;case "edit":D(!0,a);break;case "browse":a=a.next(".cpme-file-browser");M(a);a.trigger("click.codeparlMarkdown");break;case "fullscreen":b("body").toggleClass("cpme-fullscreen");l.toggleClass("fullscreen");
a.find("i").toggleClass("fa-expand fa-compress");a.find("i").hasClass("fa-expand")?a.attr("data-original-title","Fullscreen"):a.attr("data-original-title","Restore");break;case "h1":n("# ","type your heading here");break;case "h2":n("## ","type your heading here");break;case "ul":n("* ","type your item here");break;case "ol":n("1. ","type your item here");break;case "rule":n("----------","rule");break;case "block":n("> ","type here");break;case "code":n("``","enter code here");break;case "bold":d.execCommand("bold");
break;case "italic":d.execCommand("italic");break;case "link":J().slideDown("fast");a.toggleClass("bg-white").parent("div").toggleClass("bg-white");a.hasClass("bg-white")||b(".cpme-modal").hide(function(){b(this).remove()});break;case "image":K().slideDown("fast"),a.toggleClass("bg-white").parent("div").toggleClass("bg-white"),a.hasClass("bg-white")||b(".cpme-modal").hide(function(){b(this).remove()}),F()}})})}function O(){var a=b("<div>").addClass("cpme-toolbar border-bottom p-1 ").css({backgroundColor:f.toolbar.bg});
for(const u in f.toolbar.buttonGroups){var c=f.toolbar.buttonGroups[u],e=L(a);for(const h in c)if(t.hasOwnProperty(h)){var g=b("<button>").addClass("btn btn-sm  cpme-btn").attr({"data-action":t[h].action,type:"button"}).attr("title",t[h].tooltip);if(null===c[h].match(/^(fa\-.+?)$/))g.text(c[h]);else{if(!1===f.fullscreen&&"btnFullscreen"===h)continue;g.html(b("<i>").addClass("fa "+c[h]))}e.append(g);"btnHelp"===h&&(f.help.show?e.addClass("cpme-md-help   "):e.remove());"btnRule"===h&&(g.html(b("<span>").addClass("cpme-rule")),
g.addClass("cpme-rule-btn"));"btnFont"===h&&e.html(I());"btnEdit"===h&&g.addClass("active");-1!==b.inArray(h,["btnEdit","btnPreview","btnHelp"])?"btnHelp"!==h&&g.append(b("<span>").text(t[h].tooltip)):g.addClass("cpme-btn-normal");"btnFullscreen"===h&&g.removeClass("cpme-btn-normal");"btnbrowse"===h&&b("<input>").attr({type:"file",accept:".md, .markdown"}).addClass("cpme-file-browser ").hide().insertAfter(g);"function"===typeof b().tooltip&&g.tooltip()}}a.find(".cpme-btn-group:lt(5)").wrapAll('<div class="cpme-wrapper-1  animated d-inline-block ">');
b("<button>").addClass("btn cpme-more py-0 my-0").append(b("<i>").addClass("fa fa-bars ")).insertAfter(b(a.find(".cpme-wrapper-1")));a.find(".cpme-btn-group:gt(6)").wrapAll('<div class="cpme-wrapper-2  float-right ">');a.find(".cpme-more").on("click.codeparlMarkdown",function(){b(this).hasClass("bg-on")?b(".cpme-wrapper-1").removeClass("slideInRight").addClass("slideOutRight"):b(".cpme-wrapper-1").removeClass("slideOutRight").addClass("slideInRight");b(this).toggleClass("bg-on")});return a}function P(){var a=
b("<div>");a.addClass("cpme-help-bar  w-100   mx-auto py-0 ");for(var c in w)b("<button>").attr({type:"button","data-key":c}).addClass("btn btn-sm btn-default cpme-help-btn shadow-none ").text(w[c].label).appendTo(a).on("click.codeparlMarkdown",function(){b(this).siblings(".cpme-help-btn").removeClass("cpmd-yellow");var e=b(".cpme-help-bar-info");e.css({top:a.height(),height:f.editor.editorHeight+"px"});e.html(b("<p>").addClass("p-4 mx-auto ").html(w[b(this).data("key")].help));e.attr("data-key",
b(this).data("key"));e.is(":hidden")&&e.slideDown("fast");b(this).hasClass("cpmd-yellow")&&e.slideUp("fast");b(this).toggleClass("cpmd-yellow")});b("<div>").addClass("cpme-help-bar-info  w-100   mx-auto py-0 ").appendTo(a).hide();b("<a>").attr({href:f.help.link.url,target:"_blank"}).text(f.help.link.text).addClass("btn btn-link cpme-help-link float-right").appendTo(a);return a}function Q(){d=ace.edit(p.get(0));d.setTheme("ace/theme/"+f.editor.theme);d.getSession().setMode("ace/mode/markdown");d.getSession().setUseWrapMode(!0);
d.getSession().setUseSoftTabs(f.editor.softTabs);d.setOptions({showGutter:f.editor.showGutter});d.setOption("fontSize",f.editor.fontSizes[f.editor.defaultFont]);ace.config.loadModule("ace/ext/language_tools",function(){m=ace.require("ace/snippets").snippetManager;d.commands.addCommand(x.bold);d.commands.addCommand(x.italic);d.commands.addCommand(x.link)})}z.Prism=z.Prism||{};Prism.manual=!0;var d=null,m=null,C=new FormData,l=null,p,k,f=null,r=new showdown.Converter({ghCompatibleHeaderId:!0,prefixHeaderId:"cpmep-",
parseImgDimensions:!0,simplifiedAutoLink:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,tasklists:!0,ghMentions:!0,ghMentionsLink:"https://github.com/{u}",openLinksInNewWindow:!0,emoji:!0,metadata:!0}),t={btnHeader1:{tooltip:"Heading 1 <h1>",action:"h1"},btnHeader2:{tooltip:"Heading 2 <h2>",action:"h2"},btnBold:{tooltip:"Strong <strong> ",action:"bold"},btnItalic:{tooltip:"Empasise <em>",action:"italic"},btnbrowse:{tooltip:"Open a markdown file",action:"browse"},btnCode:{tooltip:"Code Sample <pre><code>",
action:"code"},btnBlock:{tooltip:"Blockquote <blockquote>",action:"block"},btnList:{tooltip:"Bulleted list <ul>",action:"ul"},btnOrderedList:{tooltip:"Numbered list <ol>",action:"ol"},btnRule:{tooltip:"Horizontal rule <hr>",action:"rule"},btnLink:{tooltip:"Hyperlink <a>",action:"link"},btnImage:{tooltip:"Insert image <img>",action:"image"},btnFont:{tooltip:"",action:"font"},btnEdit:{tooltip:"Edit",action:"edit"},btnPreview:{tooltip:"Preview",action:"preview"},btnFullscreen:{tooltip:"Fullscreen",action:"fullscreen"},
btnHelp:{tooltip:"Toggle markdown help",action:"help"}};r.setFlavor("github");var w={links:{label:"Links",help:"To use links in your markdown text you just have to  use <span> http://codeparl.com - automatic! <br> [a link](https://www.codeparl.com/) <br> Format: [text](url)</span>"},images:{label:"Images",help:"Images are exactly like links, but they have an exclamation mark before  them:<br><span> ![CodeParl logo](https://codeparl.com/storage/images/logo.png) <br> Format: ![Alt Text](url)</span>The word in square brackets is the alt text, which gets displayed if the browser can't show the image. "},
styling:{label:"Styling/Heading",help:"<span> *This is italicized*, and so <br> is _this_. <br> **This is bold**, just like __this__.<br>You can ***combine*** them if you ___really have to___.</span>To break your text into sections, you can use headers: <span>A Large Header<br>============== <br><br>Smaller Subheader<br>-----------------</span>Use hash marks if you need several levels of headers: <span># Header 1 #<br> ## Header 2 ##<br>### Header 3 ###</span> Use dashes if you need a horizontal rule <span>----------</span>"},
lists:{label:"Lists",help:"Both bulleted and numbered lists are possible:<span>- Use a minus sign for a bullet<br>+ Or plus sign<br>* Or an asterisk<br><br>1. Numbered lists are easy<br>2. Markdown keeps track ofthe numbers for you<br>7. So this will be item 3.<hr>1. Lists in a list item:<br> - Indented four spaces.<br> * indented eight spaces.<br>- Four spaces again.<br>2.  You can have multiple<br>  paragraphs in a list items. <br>Just be sure to indent."}},x={bold:{name:"bold",bindKey:{win:"Ctrl-B",
mac:"Command-B"},exec:function(){var a=d.session.getTextRange(d.getSelectionRange());0===a.trim().length?(m.insertSnippet(d,"**${1:text}**"),d.find("text")):m.insertSnippet(d,"**"+a+"**");d.focus()},readOnly:!1},italic:{name:"italic",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:function(){var a=d.session.getTextRange(d.getSelectionRange());""===a?(m.insertSnippet(d,"*${1:text}*"),d.find("text")):m.insertSnippet(d,"*"+a+"*");d.focus()},readOnly:!1},link:{name:"link",bindKey:{win:"Ctrl-K",mac:"Command-K"},
exec:function(){var a=urlModal({title:"Enter Url",body:urlInputs()}).modal("show");A(a,!0)},readOnly:!1}},y={init:function(a){f=b.extend(!0,{},b.fn.codeparlMarkdown.defaults,a);p=this;p.addClass("w-100");0<this.filter(function(){return b(this).data("codeparlMarkdown")}).length&&b.error("The plugin has already been initialized.");this.data("codeparlMarkdown",f);this.css({height:f.editor.editorHeight+"px"}).addClass("cpme-editor");l=this.parent();l.addClass("w-100 border cpmd-container position-relative ").css({backgroundColor:"#F7F7F4"});
a=O(f);a.prependTo(l);a.append(b("<div>").addClass("clearfix"));f.help.show&&P().insertAfter(a);k=b("<div>").addClass("cpme-preview w-100 markdown-body overflow-auto p-2 bg-white border").hide().appendTo(l).css({height:f.editor.editorHeight+"px"});Q(f);N(f);return this},markdownContent:function(a){if(a)d.session.setValue(a),d.clearSelection();else return d.getValue()},htmlContent:function(){return r.makeHtml(d.session.getValue())},preview:function(a,c){a&&(c=b.extend(!0,{},b.fn.codeparlMarkdown.defaults,
c),l=this.parent(),k=b("<div>").addClass("cpme-preview markdown-body overflow-auto p-2 bg-white border").appendTo(l).css({height:c.editorHeight+"px",width:c.editorWidth}),0<a.trim().length&&(a=r.makeHtml(a||""),this.html(k.html(v(a))),Prism.highlightAllUnder(k[0])))},destroy:function(){}};b.fn.codeparlMarkdown=function(a){if(y[a])return y[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==b.type(a)&&a)b.error("The method "+a+" does not exist on codeparlMarkdown");else return y.init.apply(this,
arguments)};b.fn.codeparlMarkdown.defaults={fullscreen:!0,content:{allowScript:!1,image:{types:".jpeg,.jpg,.png,.gif",placeholder:"../src/photo-placeholder.jpg",backendScript:""}},help:{show:!0,link:{url:"https://www.markdownguide.org/basic-syntax/",text:"Advanced help"}},editor:{softTabs:!0,theme:"tomorrow",editorHeight:500,fontSizes:{Small:12,Normal:16,Large:18,Xlarge:26},defaultFont:"Normal",showGutter:!1},toolbar:{bg:"#F7F7F4",buttonGroups:[{btnHeader1:"H1",btnHeader2:"H2"},{btnBold:"fa-bold",
btnItalic:"fa-italic"},{btnList:"fa-list-ul",btnOrderedList:"fa-list-ol",btnRule:"line"},{btnBlock:"fa-quote-left",btnCode:"{ }"},{btnLink:"fa-link"},{btnImage:"fa-image"},{btnFont:"font-size"},{btnEdit:"fa-edit",btnbrowse:"fa-folder-open",btnPreview:"fa-eye",btnFullscreen:"fa-expand"},{btnHelp:"fa-question-circle"}]},onFileBrowse:function(a,c){if(a[0].files[0]){var e=new FileReader;e.onload=function(g){c.session.setValue(g.target.result);c.clearSelection()};e.readAsText(a[0].files[0])}},onPreview:function(a,
c){}}})(jQuery,window);